---
title: "Lab 8: Data Augmentation"
author: "Olivier Binette"
date: "Friday October 9, 2020"
fontsize: 11pt
output: 
  beamer_presentation:
    include:
      in_header: preamble.tex
---

```{r, echo=FALSE, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.width=4, fig.height=3, fig.align="center")
set.seed(1)
```

# Agenda

-   Problem statement
-   Go through the lab's tasks
-   Office hours

# 

\section{Problem statement}

# Problem statement

Data points $Y_1, Y_2, \dots, Y_n$ coming from a **mixture model**: $$
  Y_i \sim \sum_{j=1}^n w_j N(\mu_j, \varepsilon^2).
$$ \pause

**What does this mean?**\pause

For every data point:\pause

-   let $Z_i$ be a random variable such that $\mathbb{P}(Z_i = j) = w_j$ for $j=1,2,3$,\pause
-   let $Y_i \mid Z_i \sim N(\mu_{Z_i}, \varepsilon^2)$.

# Problem statement

Let's see what this mixture model could look like in an example.\pause

Let $\mu_1 = -5$, $\mu_2 = 0$ and $\mu_3 = 5$, and let $\varepsilon = 1$. Let $w_j = 1/3$ for $j = 1,2,3$.\pause

Now let's generate data from the mixture model:

\small

```{r, eval = FALSE}
n = 100
mu = c(-5, 0, 5)
  
Z = sample(1:3, size=n, replace=TRUE)
Y = rnorm(n, mean=mu[Z], sd=1)

hist(Y, breaks=20)
```

\normalfont

# Problem statement

```{r, eval = TRUE, echo=FALSE}
n = 100
mu = c(-5, 0, 5)
  
Z = sample(1:3, size=n, replace=TRUE)
Y = rnorm(n, mean=mu[Z], sd=1)

hist(Y, breaks=20)
```

# Problem statement

We have the model 
$$
  Y_i \sim \sum_{j=1}^n w_j N(\mu_j, \varepsilon^2),
$$
\pause now we need priors on the unknown parameters $\mu_j$, $w_j$ and $\varepsilon$.\pause

## Priors

**For the means:**
\begin{align*}
  \mu_j \mid \mu_0, \sigma_0 &\sim N(\mu_0, \sigma_0^2)\\\pause
  \mu_0 &\sim N(0,3)\\\pause
  \sigma_0^2 &\sim IG(2,2)\pause
\end{align*}
and recall that $\sigma_0^2\sim IG(2,2)$ means that $\phi_0 = 1/\sigma_0^2 \sim \text{Gamma}(2,2)$.

# Problem statement

## Priors

**For the mixture weights:**
$$
  (w_1, w_2, w_3) \sim \text{Dirichlet}(\boldsymbol{1})\pause
$$
which means that $p(w_1, w_2, w_3) \propto 1$.\pause

Recall that, in general, 
\begin{align*}
&(w_1, w_2, w_3) \sim \text{Dirichlet}(\alpha_1, \alpha_2, \alpha_3)\\ 
\Rightarrow &p(w_1, w_2, w_3) \propto w_1^{\alpha_1-1} w_2^{\alpha_2-1} w_3^{\alpha_3-1}.
\end{align*}


# Problem statement

## Priors

**For the variance:**
$$
  \varepsilon^2 \sim IG(2,2)
$$
\pause

This means that
$$
  \tau = 1/\varepsilon^2 \sim \text{Gamma}(2,2)
$$

# Problem statement

In summary,
\begin{align*}
p(Y_i | \mu_1,\mu_2,\mu_3,w_1,w_2,w_3,\tau) &= \sum_{j=1}^3 w_i N(\mu_j, \tau^{-1})\\
\mu_j|\mu_0,\sigma_0^2 &\sim N(\mu_0,\phi_0^{-1})\\
\mu_0 &\sim N(0,3)\\
\phi_0 &\sim \text{Gamma}(2,2)\\
(w_1,w_2,w_3) &\sim Dirichlet(\mathbf{1})\\
\tau &\sim \text{Gamma}(2,2),
\end{align*}
for $i=1,\ldots n.$




